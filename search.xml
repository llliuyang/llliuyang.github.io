<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>PHP之MySQL数据库学习</title>
      <link href="/mysql/php-zhi-mysql-shu-ju-ku-xue-xi/"/>
      <url>/mysql/php-zhi-mysql-shu-ju-ku-xue-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="MySQL数据库学习笔记-一"><a href="#MySQL数据库学习笔记-一" class="headerlink" title="MySQL数据库学习笔记(一)"></a>MySQL数据库学习笔记(一)</h1><h2 id="一、数据库的创建"><a href="#一、数据库的创建" class="headerlink" title="一、数据库的创建"></a>一、数据库的创建</h2><h3 id="1、创建数据库"><a href="#1、创建数据库" class="headerlink" title="1、创建数据库"></a>1、创建数据库</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//创建数据库</span><span class="token variable">$createDb</span> <span class="token operator">=</span> <span class="token string">"CREATE DATABASE database_name"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="2、检测数据库创建结果"><a href="#2、检测数据库创建结果" class="headerlink" title="2、检测数据库创建结果"></a>2、检测数据库创建结果</h3><h4 id="2-1、面向对象方法"><a href="#2-1、面向对象方法" class="headerlink" title="2.1、面向对象方法"></a>2.1、面向对象方法</h4><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$conn</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$createDb</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"数据库创建成功！"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"Error creating database: "</span> <span class="token punctuation">.</span> <span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">error</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-2、面向过程方法"><a href="#2-2、面向过程方法" class="headerlink" title="2.2、面向过程方法"></a>2.2、面向过程方法</h4><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">,</span><span class="token variable">$createDb</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"数据库创建成功！"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"Error creating database: "</span> <span class="token punctuation">.</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="二、创建数据表"><a href="#二、创建数据表" class="headerlink" title="二、创建数据表"></a>二、创建数据表</h2><h3 id="1、创建表"><a href="#1、创建表" class="headerlink" title="1、创建表"></a>1、创建表</h3><blockquote><p>语法：<code>CREATE TABLE table_name();</code></p></blockquote><p><strong>实例</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$createTable</span> <span class="token operator">=</span> "<span class="token constant">CREATE</span> <span class="token constant">TABLE</span> <span class="token function">members</span> <span class="token punctuation">(</span>id <span class="token function">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token constant">UNSIGNED</span> <span class="token constant">AUTO_INCREMENT</span> <span class="token constant">PRIMARY</span> <span class="token constant">KEY</span><span class="token punctuation">,</span>姓名 <span class="token function">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token constant">NOT</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>电话 <span class="token function">VARCHAR</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token constant">NOT</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>内容 <span class="token function">VARCHAR</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span> <span class="token constant">NOT</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>参数说明</strong></p><table><thead><tr><th>约束</th><th>说明</th></tr></thead><tbody><tr><td>NOT NULL</td><td>每一行都必须含有值（不能为空），null 值是不允许的。</td></tr><tr><td>DEFAULT</td><td>规定没有给列赋值时的默认值。</td></tr><tr><td>UNIQUE</td><td>保证某列的每行必须有唯一的值。</td></tr><tr><td>CHECK</td><td>保证列中的值符合指定的条件。</td></tr><tr><td>FOREIGN KEY</td><td>保证一个表中的数据匹配另一个表中的值的参照完整性。</td></tr><tr><td>PRIMARY KEY</td><td>NOT NULL 和 UNIQUE 的结合。确保某列（或两个列多个列的结合）有唯一标识，有助于更容易更快速地找到表中的一个特定的记录。</td></tr></tbody></table><h3 id="2、检测表的创建"><a href="#2、检测表的创建" class="headerlink" title="2、检测表的创建"></a>2、检测表的创建</h3><h4 id="2-1、面向对象方法-1"><a href="#2-1、面向对象方法-1" class="headerlink" title="2.1、面向对象方法"></a>2.1、面向对象方法</h4><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$conn</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$createTable</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"数据表创建成功&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">'数据表创建错误：'</span> <span class="token punctuation">.</span><span class="token variable">$conn</span> <span class="token operator">-</span><span class="token operator">></span> error<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-2、面向过程方法-1"><a href="#2-2、面向过程方法-1" class="headerlink" title="2.2、面向过程方法"></a>2.2、面向过程方法</h4><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">,</span><span class="token variable">$createTable</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"数据表创建成功&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">'数据表创建错误：'</span> <span class="token punctuation">.</span><span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3、向表中插入数据"><a href="#3、向表中插入数据" class="headerlink" title="3、向表中插入数据"></a>3、向表中插入数据</h3><p>在创建完数据表后，我们可以向表中插入数据，但须遵循一些语法规则：</p><ul><li>PHP 中 SQL 查询语句必须使用引号</li><li>在 SQL 查询语句中的字符串值必须加引号</li><li>数值的值不需要引号</li><li>NULL 值不需要引号</li></ul><h4 id="3-1、语法用法"><a href="#3-1、语法用法" class="headerlink" title="3.1、语法用法"></a>3.1、语法用法</h4><blockquote><p><strong>语法：</strong><br><code>INSERT INTO table_name (column1, column2, column3,...)VALUES (value1, value2, value3,...)</code></p></blockquote><p><strong>实例</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token comment" spellcheck="true">//参照上方规则：字符串必须加引号</span><span class="token variable">$insertData</span> <span class="token operator">=</span> "<span class="token constant">INSERT</span> <span class="token constant">INTO</span> <span class="token function">members</span> <span class="token punctuation">(</span>姓名<span class="token punctuation">,</span>电话<span class="token punctuation">,</span>内容<span class="token punctuation">)</span><span class="token function">VALUES</span> <span class="token punctuation">(</span><span class="token string">'".$name."'</span><span class="token punctuation">,</span><span class="token variable">$phone</span><span class="token punctuation">,</span><span class="token string">'".$comment."'</span><span class="token punctuation">)</span>"<span class="token punctuation">;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-2、检测插入数据结果"><a href="#3-2、检测插入数据结果" class="headerlink" title="3.2、检测插入数据结果"></a>3.2、检测插入数据结果</h4><h5 id="3-2-1、面向对象方法"><a href="#3-2-1、面向对象方法" class="headerlink" title="3.2.1、面向对象方法"></a>3.2.1、面向对象方法</h5><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$insertData</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant">TRUE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"新记录插入成功"</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"Error: "</span> <span class="token punctuation">.</span> <span class="token variable">$insertData</span> <span class="token punctuation">.</span> <span class="token string">"&lt;br>"</span> <span class="token punctuation">.</span> <span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">error</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="3-2-2、面向过程方法"><a href="#3-2-2、面向过程方法" class="headerlink" title="3.2.2、面向过程方法"></a>3.2.2、面向过程方法</h5><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">,</span> <span class="token variable">$insertData</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"新记录插入成功"</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"Error: "</span> <span class="token punctuation">.</span> <span class="token variable">$insertData</span> <span class="token punctuation">.</span> <span class="token string">"&lt;br>"</span> <span class="token punctuation">.</span>  <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="三、数据库连接"><a href="#三、数据库连接" class="headerlink" title="三、数据库连接"></a>三、数据库连接</h2><h3 id="1、面向对象方法"><a href="#1、面向对象方法" class="headerlink" title="1、面向对象方法"></a>1、面向对象方法</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//数据库连接</span><span class="token variable">$conn</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token variable">$servername</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">,</span><span class="token variable">$database_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//连接检测</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$conn</span> <span class="token operator">-</span><span class="token operator">></span> connect_error<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"Connection failed:"</span><span class="token punctuation">.</span><span class="token variable">$conn</span> <span class="token operator">-</span><span class="token operator">></span> connect_error<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"数据库连接成功。&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2、面向过程方法"><a href="#2、面向过程方法" class="headerlink" title="2、面向过程方法"></a>2、面向过程方法</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//数据库连接</span><span class="token variable">$conn</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token variable">$servername</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">,</span><span class="token variable">$database_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//检测连接</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$conn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"Connection failed: "</span> <span class="token punctuation">.</span><span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"数据库连接成功。"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="四、从数据库读取数据"><a href="#四、从数据库读取数据" class="headerlink" title="四、从数据库读取数据"></a>四、从数据库读取数据</h2><blockquote><p>语法：</p><ul><li><code>SELECT column_name(s) FROM table_name</code></li><li><code>SELECT * FROM table_name</code> 读取所有字段</li></ul></blockquote><h3 id="1、面向对象方法-1"><a href="#1、面向对象方法-1" class="headerlink" title="1、面向对象方法"></a>1、面向对象方法</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//读取数据</span><span class="token variable">$fecth</span> <span class="token operator">=</span> <span class="token string">"SELECT * FROM members"</span><span class="token punctuation">;</span><span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$conn</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$fecth</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//检测读取结果并输出</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$res</span> <span class="token operator">-</span><span class="token operator">></span> num_rows <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$res</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token constant">HTML</span>    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tbodyrow<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id tbody<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token punctuation">{</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name tbody<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token punctuation">{</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">"姓名"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>phone tbody<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token punctuation">{</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">"电话"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>comment tbody<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token punctuation">{</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">"内容"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span></span><span class="token constant">HTML</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string">"0结果"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2、面向过程方法-1"><a href="#2、面向过程方法-1" class="headerlink" title="2、面向过程方法"></a>2、面向过程方法</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//读取数据</span><span class="token variable">$fecth</span> <span class="token operator">=</span> <span class="token string">"SELECT * FROM members"</span><span class="token punctuation">;</span><span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">,</span><span class="token variable">$fecth</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//检测读取结果并输出</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_num_rows</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysqli_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token constant">HTML</span>    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tbodyrow<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id tbody<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token punctuation">{</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name tbody<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token punctuation">{</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">"姓名"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>phone tbody<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token punctuation">{</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">"电话"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>comment tbody<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token punctuation">{</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">"内容"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span></span><span class="token constant">HTML</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string">"0结果"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h3><h4 id="1、WHERE"><a href="#1、WHERE" class="headerlink" title="1、WHERE"></a>1、WHERE</h4><blockquote><p>WHERE 子句用于提取满足指定标准的的记录。</p></blockquote><p><strong>语法：</strong></p><pre><code>SELECT column_name(s) FROM table_nameWHERE column_name operator value</code></pre><p><strong>实例</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$where</span> <span class="token operator">=</span> <span class="token string">"SELECT * FROM members WHERE 姓名='张三' "</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2、ORDER-BY"><a href="#2、ORDER-BY" class="headerlink" title="2、ORDER BY"></a>2、ORDER BY</h4><blockquote><p>ORDER BY 关键词用于对记录集中的数据进行排序。<br>默认升序排序，可以使用 DESC 进行降序排序。</p></blockquote><p><strong>语法：</strong></p><pre><code>SELECT column_name(s)FROM table_nameORDER BY column_name(s) ASC|DESC</code></pre><p><strong>实例</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$order</span> <span class="token operator">=</span> "<span class="token constant">SELECT</span> <span class="token operator">*</span> <span class="token constant">FROM</span> members <span class="token constant">ORDER</span> <span class="token constant">BY</span> id <span class="token constant">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>根据两列进行排序</strong></p><p>可以根据多个列进行排序。当按照多个列进行排序时，只有第一列的值相同时才使用第二列：</p><pre class="line-numbers language-php"><code class="language-php"><span class="token constant">SELECT</span> <span class="token function">column_name</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token constant">FROM</span> table_name<span class="token constant">ORDER</span> <span class="token constant">BY</span> column1<span class="token punctuation">,</span> column2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>特殊：拼音排序</strong></p><p>拼音排序需要根据字符集采用的编码决定使用方法</p><table><thead><tr><th>字符集</th><th>使用方法</th></tr></thead><tbody><tr><td>gbk (中文编码)</td><td>直接在查询语句后边添加 <code>ORDER BY</code></td></tr><tr><td>utf8 (万国码)</td><td>先对字段进行转码然后排序。<br>方法：<code>CONVERT(row_title using gbk)</code></td></tr></tbody></table><p>实例：现有表格如下。对表格按姓名拼音排序</p><table><thead><tr><th>id</th><th>姓名</th><th>性别</th></tr></thead><tbody><tr><td>1</td><td>丁一</td><td>女</td></tr><tr><td>2</td><td>牛二</td><td>男</td></tr><tr><td>3</td><td>张三</td><td>男</td></tr></tbody></table><p>执行操作(由于原本是拼音升序，所以这里我们用降序来区别)</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$orderPy</span> <span class="token operator">=</span> "<span class="token constant">SELECT</span> <span class="token operator">*</span> <span class="token constant">FROM</span> members<span class="token constant">ORDER</span> <span class="token constant">BY</span> <span class="token function">CONVERT</span><span class="token punctuation">(</span>姓名 using gbk<span class="token punctuation">)</span> <span class="token constant">DESC</span>"<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>输出结果：</p><table><thead><tr><th>id</th><th>姓名</th><th>性别</th></tr></thead><tbody><tr><td>3</td><td>张三</td><td>男</td></tr><tr><td>2</td><td>牛二</td><td>男</td></tr><tr><td>1</td><td>丁一</td><td>女</td></tr></tbody></table><h4 id="3、UPDATE"><a href="#3、UPDATE" class="headerlink" title="3、UPDATE"></a>3、UPDATE</h4><blockquote><p>UPDATE 语句用于更新数据库表中已存在的记录。</p></blockquote><p><strong>语法：</strong></p><pre><code>UPDATE table_nameSET column1=value, column2=value2,...WHERE some_column=some_value</code></pre><blockquote><p>注意：UPDATE 语法中的 WHERE 子句。WHERE 子句规定了哪些记录需要更新。如果您想省去 WHERE 子句，所有的记录都会被更新！</p></blockquote><p><strong>实例</strong></p><p>现有如下表格：（已设置降序排列）</p><table><thead><tr><th>id</th><th>姓名</th><th>电话</th><th>内容</th></tr></thead><tbody><tr><td>3</td><td>张三</td><td>333</td><td>我叫张三</td></tr><tr><td>2</td><td>牛二</td><td>222</td><td>我叫牛二</td></tr><tr><td>1</td><td>丁一</td><td>111</td><td>我叫丁一</td></tr></tbody></table><p>修改更新表中 张三 为 李四</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$updateData</span> <span class="token operator">=</span> "<span class="token constant">UPDATE</span> members <span class="token constant">SET</span> 姓名<span class="token operator">=</span><span class="token string">'李四'</span><span class="token constant">WHERE</span> 姓名 <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>输出结果</p><table><thead><tr><th>id</th><th>姓名</th><th>电话</th><th>内容</th></tr></thead><tbody><tr><td>3</td><td>李四</td><td>333</td><td>我叫张三</td></tr><tr><td>2</td><td>牛二</td><td>222</td><td>我叫牛二</td></tr><tr><td>1</td><td>丁一</td><td>111</td><td>我叫丁一</td></tr></tbody></table><p><strong>UPDATE方法可以同时修改一条数据的多个字段</strong></p><p>修改更新表中</p><ul><li>张三 ——&gt; 李四</li><li>333 ——&gt; 444</li><li>我叫张三 ——&gt; 我叫李四</li></ul><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$updateData</span> <span class="token operator">=</span> "<span class="token constant">UPDATE</span> members <span class="token constant">SET</span> 姓名<span class="token operator">=</span><span class="token string">'李四'</span><span class="token punctuation">,</span>电话 <span class="token operator">=</span> <span class="token string">'444'</span><span class="token punctuation">,</span> 内容 <span class="token operator">=</span> <span class="token string">'我叫李四'</span><span class="token constant">WHERE</span> 姓名 <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>输出结果：</p><table><thead><tr><th>id</th><th>姓名</th><th>电话</th><th>内容</th></tr></thead><tbody><tr><td>3</td><td>李四</td><td>444</td><td>我叫李四</td></tr><tr><td>2</td><td>牛二</td><td>222</td><td>我叫牛二</td></tr><tr><td>1</td><td>丁一</td><td>111</td><td>我叫丁一</td></tr></tbody></table><blockquote><p>id设置为 <code>PRIMARY KEY</code>,不要轻易去改变它,若需要改变，不可与已存在的重复，否则无法更新数据。</p></blockquote><h4 id="4、DELETE"><a href="#4、DELETE" class="headerlink" title="4、DELETE"></a>4、DELETE</h4><blockquote><p>DELETE 语句用于从数据库表中<strong>删除行</strong>。</p></blockquote><p><strong>语法：</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token constant">DELETE</span> <span class="token constant">FROM</span> table_name<span class="token constant">WHERE</span> some_column <span class="token operator">=</span> some_value<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>注意：DELETE中的WHERE子句。WHERE 子句规定了哪些记录需要删除。如果您想省去 WHERE 子句，所有的记录都会被删除！</p></blockquote><p><strong>实例</strong></p><p>现有表格同上，需要删除id为3的行：</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$delete</span> <span class="token operator">=</span> " <span class="token constant">DELETE</span> <span class="token constant">FROM</span> members<span class="token constant">WHERE</span> 姓名 <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>输出结果：</p><table><thead><tr><th>id</th><th>姓名</th><th>电话</th><th>内容</th></tr></thead><tbody><tr><td>2</td><td>牛二</td><td>222</td><td>我叫牛二</td></tr><tr><td>1</td><td>丁一</td><td>111</td><td>我叫丁一</td></tr></tbody></table><p><code>drop</code> <code>truncate</code>和 <code>delete</code>都可以对数据表进行删除操作，具体区别如下表：</p><table><thead><tr><th>语句</th><th>含义</th></tr></thead><tbody><tr><td>drop</td><td><strong>删除表</strong>。删除表及其结构。<strong>不可回滚</strong></td></tr><tr><td>truncate</td><td><strong>清空表</strong>。删除表中所有数据，保留表结构。<strong>不可回滚</strong></td></tr><tr><td>delete</td><td><strong>删除行</strong>。删除操作作为事务记录在日志中。<strong>可以回滚</strong></td></tr></tbody></table><blockquote><p><code>TRUNCATE</code>与不带 <code>WHERE</code> 的 <code>DELETE</code> 都是删除表数据，保留表结构。</p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>$_FILES(二)文件的上传</title>
      <link href="/php-xue-xi/wen-jian-cao-zuo-er-wen-jian-de-shang-chuan/"/>
      <url>/php-xue-xi/wen-jian-cao-zuo-er-wen-jian-de-shang-chuan/</url>
      
        <content type="html"><![CDATA[<blockquote><p>在上一节中学习了<code>$_FILES</code>的基本使用，本节将继续学习它的进阶用法：文件的上传与 校验</p></blockquote><h2 id="1、创建上传表单"><a href="#1、创建上传表单" class="headerlink" title="1、创建上传表单"></a>1、创建上传表单</h2><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file.php<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>提交<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>说明：</p><ul><li><code>form</code>标签的 <code>enctype</code>属性规定了在提交表单时要使用哪种内容类型。在表单需要二进制数据时，比如文件内容，请使用 <code>multipart/form-data</code>。</li><li><code>input</code> 标签的 <code>type="file"</code>属性规定了应该把输入作为文件来处理。举例来说，当在浏览器中预览时，会看到输入框旁边有一个浏览按钮。</li></ul></blockquote><h2 id="2、创建上传脚本"><a href="#2、创建上传脚本" class="headerlink" title="2、创建上传脚本"></a>2、创建上传脚本</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"错误："</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"上传文件名: "</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string">"文件类型: "</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string">"文件大小: "</span> <span class="token punctuation">.</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"size"</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token string">" kB&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string">"文件临时存储的位置: "</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>说明：以上语法第一个参数是表单中input的<code>name</code>，第二个参数为文件上传属性，具体参数见下表</p></blockquote><p><strong>第二参数详解</strong></p><table><thead><tr><th>参数</th><th>释义</th></tr></thead><tbody><tr><td>name</td><td>上传文件的名称</td></tr><tr><td>type</td><td>上传文件的类型</td></tr><tr><td>size</td><td>上传文件的大小，以字节（B）计算</td></tr><tr><td>tmp_name</td><td>文件被上传后在服务端储存的临时文件名，一般是系统默认</td></tr><tr><td>error</td><td>该文件上传相关的错误代码。<br>PHP 4.2.0 版本中增加，PHP4.3之后变成常量</td></tr></tbody></table><p><strong>error错误类型和值</strong></p><table><thead><tr><th>错误类型</th><th>值 - 说明</th></tr></thead><tbody><tr><td>UPLOAD_ERR_OK</td><td><strong>0</strong> 。没有错误发生，文件上传成功</td></tr><tr><td>UPLOAD_ERR_INI_SIZE</td><td><strong>1</strong> 。上传的文件超过了 php.ini 中 upload_max_filesize选项限制的值</td></tr><tr><td>UPLOAD_ERR_FORM_SIZE</td><td><strong>2</strong> 。上传文件的大小超过了 HTML 表单中 MAX_FILE_SIZE 选项指定的值</td></tr><tr><td>UPLOAD_ERR_PARTIAL</td><td><strong>3</strong> 。文件只有部分被上传</td></tr><tr><td>UPLOAD_ERR_NO_FILE</td><td><strong>4</strong> 。文件没有被上传</td></tr><tr><td>UPLOAD_ERR_NO_TMP_DIR</td><td><strong>6</strong> 。找不到临时文件夹。PHP 4.3.10 和 PHP 5.0.3 引进</td></tr><tr><td>UPLOAD_ERR_CANT_WRITE</td><td><strong>7</strong> 。文件写入失败。PHP 5.1.0 引进</td></tr></tbody></table><h2 id="3、对上传文件进行限制"><a href="#3、对上传文件进行限制" class="headerlink" title="3、对上传文件进行限制"></a>3、对上传文件进行限制</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">//设置允许用户上传的文件类型</span><span class="token variable">$allowExts</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'jpg'</span><span class="token punctuation">,</span><span class="token string">'jpeg'</span><span class="token punctuation">,</span><span class="token string">'gif'</span><span class="token punctuation">,</span><span class="token string">'png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//使用explode()语法将文件名分成两段</span><span class="token variable">$fenge</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//取出文件名后缀</span><span class="token variable">$exts</span> <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token variable">$fenge</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//如果文件后缀名在允许数组内，就允许上传</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$exts</span><span class="token punctuation">,</span><span class="token variable">$allowExts</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//若上传成功，打印文件信息，若上传失败，则抛出错误信息</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'&lt;br> '</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">'文件名:'</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'&lt;br>'</span> <span class="token punctuation">.</span>         <span class="token string">'文件类型：'</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'&lt;br>'</span> <span class="token punctuation">.</span>         <span class="token string">"文件临时存储的名字: "</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"tmp_name"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'&lt;br>'</span> <span class="token punctuation">.</span>         <span class="token string">'文件大小：'</span> <span class="token punctuation">.</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"size"</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token string">'kbyte&lt;br>'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//如果文件后缀名不符合规定，则给出提示</span>    <span class="token keyword">echo</span>  <span class="token string">"错误的文件格式"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4、对上传的文件进行保存"><a href="#4、对上传的文件进行保存" class="headerlink" title="4、对上传的文件进行保存"></a>4、对上传的文件进行保存</h2><blockquote><p><strong>注意：</strong>文件被上传结束后，默认地被存储在了临时目录中，这时您必须将它从临时目录中删除或移动到其它地方，如果没有，不管是否上传成功，脚本执行完后临时目录里的文件肯定会被删除。所以在删除之前要用PHP的 <code>copy()</code> 或者 <code>move_uploaded_file()</code>将它复制或移动到其它位置，此时，才算完成了上传文件过程。</p></blockquote><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">//设置允许用户上传的文件类型</span><span class="token variable">$allowExts</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'jpg'</span><span class="token punctuation">,</span><span class="token string">'jpeg'</span><span class="token punctuation">,</span><span class="token string">'gif'</span><span class="token punctuation">,</span><span class="token string">'png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//使用explode()语法将文件名分成两段</span><span class="token variable">$fenge</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//取出文件名后缀</span><span class="token variable">$exts</span> <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token variable">$fenge</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//如果文件后缀名在允许数组内，就允许上传</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$exts</span><span class="token punctuation">,</span><span class="token variable">$allowExts</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//若上传成功，打印文件信息，若上传失败，则抛出错误信息</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'&lt;br> '</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//上传成功，执行</span>    <span class="token keyword">echo</span> <span class="token string">'文件名:'</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'&lt;br>'</span> <span class="token punctuation">.</span>         <span class="token string">'文件类型：'</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'&lt;br>'</span> <span class="token punctuation">.</span>         <span class="token string">"文件临时存储的名字: "</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"tmp_name"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'&lt;br>'</span> <span class="token punctuation">.</span>         <span class="token string">'文件大小：'</span> <span class="token punctuation">.</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"size"</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token string">'kbyte&lt;br>'</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//检查文件是否存在</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string">"cunchu/"</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'文件已存在&lt;br>'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//若不存在，则将临时文件移动到存储位置</span>        <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'cunchu/'</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//如果文件后缀名不符合规定，则给出提示</span>    <span class="token keyword">echo</span>  <span class="token string">"错误的文件格式"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>用法：<code>move_uploaded_file(file,newloc)</code><br>若移动成功，返回true，否则返回false<br> <strong>参数说明：</strong></p><ul><li><code>file</code> 需要移动的文件</li><li><code>newloc</code> 文件的新位置</li></ul></blockquote><p><strong>到此，文件才算上传完成。允许用户上传文件是一个巨大的安全风险。请仅仅允许可信的用户执行文件上传操作并对上传文件进行严格校验。</strong></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> PHP学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> $_FILES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>$_FILES(一)文件的基本操作</title>
      <link href="/php-xue-xi/wen-jian-cao-zuo-yi-wen-jian-de-ji-ben-cao-zuo/"/>
      <url>/php-xue-xi/wen-jian-cao-zuo-yi-wen-jian-de-ji-ben-cao-zuo/</url>
      
        <content type="html"><![CDATA[<blockquote><p>文档回顾：PHP 中预定义了几个超级全局变量（superglobals） ，PHP 4.1.0 之后被启用，这意味着它们在一个脚本的全部作用域中都可用。你不需要特别说明，就可以在函数及类中使用。</p></blockquote><h2 id="1、fopen-函数：在-PHP-中-打开文件"><a href="#1、fopen-函数：在-PHP-中-打开文件" class="headerlink" title="1、fopen()函数：在 PHP 中 打开文件"></a>1、fopen()函数：在 PHP 中 打开文件</h2><blockquote><p>使用方法：<code>fopen(参数1,参数2)</code></p></blockquote><p><strong>参数说明：</strong></p><table><thead><tr><th>参数 1</th><th>参数 2</th></tr></thead><tbody><tr><td>要打开的文件的名称 &nbsp;&nbsp;例如：readme.txt</td><td>规定打开文件使用模式</td></tr></tbody></table><p><strong>打开文件可使用的模式表</strong></p><table><thead><tr><th>模式</th><th>描述</th></tr></thead><tbody><tr><td>r</td><td><strong>只读。</strong> 在文件开头开始</td></tr><tr><td>r+</td><td><strong>读/写。</strong>在文件的开头开始</td></tr><tr><td>w</td><td><strong>只写。</strong>打开并清空文件的内容；如果文件不存在，则创建新文件</td></tr><tr><td>w+</td><td><strong>读/写。</strong>打开并清空文件的内容；如果文件不存在，则创建新文件</td></tr><tr><td>a</td><td><strong>追加。</strong>打开并向文件末尾进行写操作，如果文件不存在，则创建新文件</td></tr><tr><td>a+</td><td><strong>读/追加。</strong>通过向文件末尾写内容，来保持文件内容</td></tr><tr><td>x</td><td><strong>只写。</strong>创建新文件。如果文件已存在，则返回 FALSE 和一个错误</td></tr><tr><td>x+</td><td><strong>读/写。</strong>创建新文件。如果文件已存在，则返回 FALSE 和一个错误</td></tr></tbody></table><blockquote><p>特别说明：如果 fopen() 函数无法打开指定文件，则返回 0 (false)。<br>因此可以使用<code>exit()</code>和<code>fopen()</code>一起使用，用于返回错误信息。</p></blockquote><p><strong>实例</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>   <span class="token variable">$file</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"readme.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">"打开文件失败!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="2、fclose-函数：关闭文件"><a href="#2、fclose-函数：关闭文件" class="headerlink" title="2、fclose()函数：关闭文件"></a>2、fclose()函数：关闭文件</h2><blockquote><p>使用方法：<code>fclose($file)</code></p></blockquote><p><strong>实例</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>   <span class="token variable">$file</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"readme.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">"打开文件失败!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// 执行代码</span>   <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3、feof-函数：检查文件末尾（EOF）"><a href="#3、feof-函数：检查文件末尾（EOF）" class="headerlink" title="3、feof()函数：检查文件末尾（EOF）"></a>3、feof()函数：检查文件末尾（EOF）</h2><blockquote><p>使用方法：<code>feof($file)</code> &gt;<strong>特别注意：在 w 、a 和 x 模式下，您无法读取打开的文件！</strong></p></blockquote><p><strong>实例</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">echo</span> <span class="token string">"这里是文件结尾"</span> <span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="4、读取文件"><a href="#4、读取文件" class="headerlink" title="4、读取文件"></a>4、读取文件</h2><p><strong>在 PHP 中，读取文件以下方式</strong></p><table><thead><tr><th align="center">方式</th><th align="center">fgets()</th><th align="center">fgetc()</th></tr></thead><tbody><tr><td align="center">描述</td><td align="center">逐行读取文件</td><td align="center">逐字符读取文件</td></tr></tbody></table><blockquote><p>说明：在调用以上任何函数之后，文件指针会移动到下一行。</p></blockquote><p><strong>实例</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"readme.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">"打开文件失败!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// echo fgetc($file);</span><span class="token punctuation">}</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> PHP学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> $_FILES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>您好，世界</title>
      <link href="/sui-bi/nin-hao-shi-jie/"/>
      <url>/sui-bi/nin-hao-shi-jie/</url>
      
        <content type="html"><![CDATA[<p>关于建立个人博客的想法已有一段时间了，总是觉得没时间、很忙、下次吧…真正操作起来，其实并没有那么复杂，就是一次又一次的去拖延，这是一个并不好的习惯，但我们都或多或少的有着这样的坏毛病。</p><p>关于博客的框架选择，之前用过<code>wordpress</code>、<code>dedeCMS</code>、<code>ECMS</code>、<code>phpMyWind</code>等，最终还是选择了hexo。主要还是觉得简单易用，作为IT男而言，用<code>markdown</code>来记录自己的成长，那真的是太酷了！</p><p>本博客主要用来记录个人的学习笔记以及遇到的困难和解决方案，方便自己复习，就当是鞭策自己进步的一种方案。如果某一点让大家有了共鸣或是有帮助，那真的是天大的良善！</p><p>有共同学习的朋友，可以加QQ或是微信共同进步，互相打气，互相监督，让技术，为我们引路，开拓视野，拥抱崭新的未来！</p><p>最后：</p><pre><code>hello world! i'm coming~</code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> 随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 开篇 </tag>
            
            <tag> 杂谈 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
